### Open

- vim filename
  - 如果已有该文件，则打开它
  - 如果没有该文件，则打开个一个新的文件，并命名为filename

![](./images/vim-1.png)

### 三种模式

- 一般命令模式
          默认模式。命令输入方式：类似于打游戏放技能，按不同字符，即可进行不同操作。可以复制、粘贴、删除文本等。
- 编辑模式
          在一般命令模式里按下i，会进入编辑模式
          按下ESC会退出编辑模式，返回到一般命令模式
- 命令行模式
          在一般命令模式里按下:/?三个字母中的任意一个，会进入命令行模式。命令行在最下面
          可以查找、替换、保存、退出、配置编辑器等

#### Normal-mode

- h、j、k、l
- `n<Space>`：n表示数字，按下数字后再按空格，光标会向右移动这一行的n个字符
- `0` 或 `[Home]`：光标移动到本行开头
- `$` 或`[End]`：光标移动到本行末尾
- `G`：光标移动到最后一行
-  `nG`：n表示数字，光标移动到第n行
- `gg`：光标移动到第一行，相当于1G
- `n<Enter>`：n表示数字，光标向下移动n行
- `nx`或`nX`, 删除光标后字符x、删除光标前字符X
- `y`：复制选中的文本
- `yy`复制当前行
- `ny$`复制光标之后、`nyw`复制单词、n表示数字
- `v`：选中文本
- `d`：删除选中的文本
- `dd`剪切、`nd$`、`ndd`同上
- `p`: 将复制的数据在光标的下一行/下一个位置粘贴
- `u`：撤销
- `Ctrl + r`反撤销
- 大于号 >：将选中的文本整体向右缩进一次
- 小于号 <：将选中的文本整体向左缩进一次
- control + u / d 翻半页

#### Command-mode(`: or /`进入模式，读取、存盘、替换、显示行号、退出vi等)

- `:w` 保存
- `:w!` 强制保存
- `:q` 退出
- `:q!` 强制退出
- `:wq` 保存并退出
- `:set nu、:set nonu`
- `:set paste` 设置成粘贴模式，取消代码自动缩进
-  `:set nopaste `取消粘贴模式，开启代码自动缩进
- `:noh` 关闭查找关键词高亮
- 查找/xxx+enter  n后找  N前找
- :w [fileName],若通过加文件名打开的vi则可以直接:w
- :q :q! :wq
- :!执行命令
- 查找
  - `/word`：向光标之下寻找第一个值为word的字符串
  - `?word`：向光标之上寻找第一个值为word的字符串
  -  `n`：重复前一个查找操作
  - `N`：反向重复前一个查找操作
- 替换（注意替换`/`需要转义）
  - `:n1,n2s/word1/word2/g`：n1与n2为数字，在第n1行与n2行之间寻找word1这个字符串，并将该字符串替换为word2
  -  `1,$s/word1/word2/g`：将全文的word1替换为word2
  -  `1,$s/word1/word2/gc`：将全文的word1替换为word2，且在替换前要求用户确认
- vim file1 file2 同时打开两个文件， 第一个文件使用yy复制， 使用:next 打开下一个文件 ，使用p命令粘贴，返回上一个文件使用:prev

### best practice

- `gg=G`：将全文代码格式化
- `Ctrl + q`：当vim卡死时，可以取消当前正在执行的命令
- `vim file1 file2` 同时打开两个文件， 第一个文件使用yy复制， 使用`:next `打开下一个文件 ，使用`p`粘贴，返回上一个文件使用`:prev`
- 异常处理：每次用vim编辑文件时，会自动创建一个.filename.swp的临时文件，如果打开某个文件时，该文件的swp文件已存在，则会报错。此时解决办法有两种：
  - 找到正在打开该文件的程序，并退出
  - 直接删掉该swp文件即可

### configuration

- /etc/virc、/etc/vimrc
  - add`set nu` in last row